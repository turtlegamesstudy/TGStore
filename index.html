<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login & Registro</title>
    <link rel="stylesheet" href="./loginandsignup.css">
</head>

<body>
    <audio id="sound-hover" src="./Sounds/Hover.mp3" preload="auto"></audio>
    <audio id="sound-error" src="./Sounds/Error.mp3" preload="auto"></audio>
    <audio id="sound-correct" src="./Sounds/Correct.mp3" preload="auto"></audio>
    <audio id="sound-bg" src="./Sounds/Background.mp3" preload="auto" autoplay loop></audio>

    <div class="container">
        <!-- Lado Izquierdo -->
        <div class="left-side">
            <img src="./IMG/Logo.png" alt="Logo" class="logo">
            <h2>TGStore</h2>
            <p>
                Bienvenido a nuestra plataforma. Aqui podras encontrar los juegos desarrollados por Turtle Games,
                Antes deberas iniciar sesion o crear una cuenta.
            </p>
        </div>

        <!-- Lado Derecho -->
        <div class="right-side">
            <div class="tab-buttons">
                <button id="btn-login" class="active">Login</button>
                <button id="btn-register">Registro</button>
            </div>

            <!-- Formulario Login -->
            <form id="form-login" class="form active">
                <h1>Inicio De Sesión</h1>
                <input type="email" id="login-email" placeholder="Correo electrónico" required>
                <input type="password" id="login-pass" placeholder="Contraseña" required>
                <button type="submit" class="btn">Iniciar Sesión</button>
            </form>

            <!-- Formulario Registro -->
            <form id="form-register" class="form">
               <h1>Registro</h1>
                <input type="text" id="register-nombre" placeholder="Nombre" required>
                <input type="email" id="register-email" placeholder="Correo electrónico" required>
                <input type="password" id="register-pass" placeholder="Contraseña" required>
                <input type="password" id="register-pass-confirm" placeholder="Confirmar contraseña" required>
                <button type="submit" class="btn">Registrarse</button>
            </form>
        </div>
    </div>

    <!-- Firebase -->
    <script type="module">
        // Importar SDKs de Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-auth.js";

        // Configuración Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyAH3QCPFQENai2BP8OBEl9pAQkOj1xPe2k",
            authDomain: "tgdatabase-73e2a.firebaseapp.com",
            projectId: "tgdatabase-73e2a",
            storageBucket: "tgdatabase-73e2a.firebasestorage.app",
            messagingSenderId: "234549403143",
            appId: "1:234549403143:web:d8820aebfedaeecc4e54a2",
            measurementId: "G-4D3GXXT58G"
        };

        // Inicializar Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        // Sonidos
        const soundHover = document.getElementById("sound-hover");
        const soundError = document.getElementById("sound-error");
        const soundCorrect = document.getElementById("sound-correct");

        // Tabs
        const btnLogin = document.getElementById("btn-login");
        const btnRegister = document.getElementById("btn-register");
        const formLogin = document.getElementById("form-login");
        const formRegister = document.getElementById("form-register");

        btnLogin.addEventListener("click", () => {
            btnLogin.classList.add("active");
            btnRegister.classList.remove("active");
            formLogin.classList.add("active");
            formRegister.classList.remove("active");
        });
        btnRegister.addEventListener("click", () => {
            btnRegister.classList.add("active");
            btnLogin.classList.remove("active");
            formRegister.classList.add("active");
            formLogin.classList.remove("active");
        });

        // Hover sonidos
        document.querySelectorAll("button").forEach(button => {
            button.addEventListener("mouseenter", () => {
                soundHover.currentTime = 0;
                soundHover.play();
            });
        });

        // Registro con Firebase
        formRegister.addEventListener("submit", async e => {
            e.preventDefault();
            const nombre = document.getElementById("register-nombre").value.trim();
            const email = document.getElementById("register-email").value.trim();
            const pass = document.getElementById("register-pass").value.trim();
            const passConfirm = document.getElementById("register-pass-confirm").value.trim();

            if (!nombre || !email || !pass || !passConfirm) {
                soundError.play();
                return alert("Por favor completa todos los campos.");
            }
            if (pass !== passConfirm) {
                soundError.play();
                return alert("Las contraseñas no coinciden.");
            }

            try {
                await createUserWithEmailAndPassword(auth, email, pass);
                soundCorrect.play();
                alert("Usuario registrado correctamente");
                setTimeout(() => window.location.href = "Home.html", 500);
            } catch (error) {
                soundError.play();
                alert("Error al registrar: " + error.message);
            }
        });

        // Login con Firebase
        formLogin.addEventListener("submit", async e => {
            e.preventDefault();
            const email = document.getElementById("login-email").value.trim();
            const pass = document.getElementById("login-pass").value.trim();

            try {
                await signInWithEmailAndPassword(auth, email, pass);
                soundCorrect.play();
                alert("Login correcto");
                window.location.href = "Home.html";
            } catch (error) {
                soundError.play();
                alert("Usuario o contraseña incorrectos");
            }
        });
    </script>
</body>
</html>
